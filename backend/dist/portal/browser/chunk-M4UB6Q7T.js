import{a as Q}from"./chunk-TYAXEZWJ.js";import{c as A,d as b,e as O,f as $,i as B,j as z,k as q,l as j,m as G,n as H,o as P,p as W,r as Y}from"./chunk-3CQ75ST4.js";import{$ as i,J as a,Q as y,R as C,Ta as k,Ua as N,W as c,_ as d,_a as L,aa as t,ba as p,db as E,e as K,eb as V,hb as D,ia as w,ja as f,ka as g,mb as R,nb as T,qb as M,sa as I,ta as U,ua as r,v as x,va as _,w as v,wa as S,xa as F}from"./chunk-ZQSPQ25S.js";var h=K(Q());function X(l,n){if(l&1){let e=w();i(0,"a",21),f("click",function(){let s=x(e).$implicit,m=g();return v(m.setActiveSidebar(s))}),p(1,"i",22),r(2),t()}if(l&2){let e=n.$implicit;I("bg-white/25",e.active),d("routerLink",e.route),a(),U(e.icon),a(),S(" ",e.label," ")}}function Z(l,n){l&1&&(i(0,"div",23),p(1,"div",24),i(2,"span",25),r(3,"Loading..."),t()())}function ee(l,n){if(l&1){let e=w();i(0,"tr",32)(1,"td",33),r(2),t(),i(3,"td",34),r(4),t(),i(5,"td",34),r(6),t(),i(7,"td",35)(8,"span",36),r(9),t()(),i(10,"td",34),r(11),t(),i(12,"td",37)(13,"button",38),f("click",function(){let s=x(e).$implicit,m=g(2);return v(m.openEditModal(s))}),p(14,"i",39),r(15," Edit "),t(),i(16,"button",40),f("click",function(){let s=x(e).$implicit,m=g(2);return v(m.deleteUser(s))}),p(17,"i",41),r(18," Delete "),t()()()}if(l&2){let e=n.$implicit,o=g(2);a(2),_(e.UserID),a(2),F("",e.FirstName," ",e.LastName),a(2),_(e.Email),a(2),U(o.getRoleBadgeClass(e.UserRoleID)),a(),S(" ",o.getRoleName(e.UserRoleID)," "),a(2),_(e.UnitName||"N/A")}}function te(l,n){if(l&1&&(i(0,"div",26)(1,"table",27)(2,"thead",28)(3,"tr")(4,"th",29),r(5,"ID"),t(),i(6,"th",29),r(7,"Name"),t(),i(8,"th",29),r(9,"Email"),t(),i(10,"th",29),r(11,"Role"),t(),i(12,"th",29),r(13,"Unit"),t(),i(14,"th",29),r(15,"Actions"),t()()(),i(16,"tbody",30),c(17,ee,19,8,"tr",31),t()()()),l&2){let e=g();a(17),d("ngForOf",e.users)}}function ie(l,n){l&1&&(i(0,"div",42),p(1,"i",43),i(2,"h4",44),r(3,"No Users Found"),t(),i(4,"p",45),r(5,"No users have been registered yet."),t()())}function re(l,n){l&1&&(i(0,"div",64),r(1,"First name is required."),t())}function ne(l,n){l&1&&(i(0,"div",64),r(1,"Last name is required."),t())}function oe(l,n){l&1&&(i(0,"span"),r(1,"Email is required."),t())}function le(l,n){l&1&&(i(0,"span"),r(1,"Invalid email format."),t())}function ae(l,n){if(l&1&&(i(0,"div",64),c(1,oe,2,0,"span",65)(2,le,2,0,"span",65),t()),l&2){let e,o,s=g(2);a(),d("ngIf",(e=s.editForm.get("email"))==null||e.errors==null?null:e.errors.required),a(),d("ngIf",(o=s.editForm.get("email"))==null||o.errors==null?null:o.errors.email)}}function se(l,n){if(l&1&&(i(0,"option",66),r(1),t()),l&2){let e=n.$implicit;d("value",e.value),a(),_(e.viewValue)}}function de(l,n){l&1&&(i(0,"div",64),r(1,"Role is required."),t())}function me(l,n){if(l&1){let e=w();i(0,"div",46),f("click",function(){x(e);let s=g();return v(s.closeEditModal())}),i(1,"div",47),f("click",function(s){return x(e),v(s.stopPropagation())}),i(2,"div",48)(3,"h3",49),r(4,"Edit User"),t(),i(5,"form",50),f("ngSubmit",function(){x(e);let s=g();return v(s.onEditSubmit())}),i(6,"div",51)(7,"label",52),r(8,"First Name*"),t(),p(9,"input",53),c(10,re,2,0,"div",54),t(),i(11,"div",51)(12,"label",52),r(13,"Last Name*"),t(),p(14,"input",55),c(15,ne,2,0,"div",54),t(),i(16,"div",51)(17,"label",52),r(18,"Email*"),t(),p(19,"input",56),c(20,ae,3,2,"div",54),t(),i(21,"div",51)(22,"label",52),r(23,"Role*"),t(),i(24,"select",57)(25,"option",58),r(26,"Select a role"),t(),c(27,se,2,2,"option",59),t(),c(28,de,2,0,"div",54),t(),i(29,"div",51)(30,"label",52),r(31,"Organization Unit ID"),t(),p(32,"input",60),t(),i(33,"div",61)(34,"button",62),f("click",function(){x(e);let s=g();return v(s.closeEditModal())}),r(35,"Cancel"),t(),i(36,"button",63),r(37,"Update User"),t()()()()()()}if(l&2){let e,o,s,m,u=g();a(5),d("formGroup",u.editForm),a(5),d("ngIf",((e=u.editForm.get("firstName"))==null?null:e.touched)&&((e=u.editForm.get("firstName"))==null?null:e.invalid)),a(5),d("ngIf",((o=u.editForm.get("lastName"))==null?null:o.touched)&&((o=u.editForm.get("lastName"))==null?null:o.invalid)),a(5),d("ngIf",((s=u.editForm.get("email"))==null?null:s.touched)&&((s=u.editForm.get("email"))==null?null:s.invalid)),a(5),d("ngValue",null),a(2),d("ngForOf",u.roles),a(),d("ngIf",((m=u.editForm.get("userRoleID"))==null?null:m.touched)&&((m=u.editForm.get("userRoleID"))==null?null:m.invalid)),a(8),d("disabled",u.editForm.invalid)}}var J=class l{constructor(n,e,o){this.fb=n;this.http=e;this.router=o;this.editForm=this.fb.group({email:["",[b.required,b.email]],firstName:["",b.required],lastName:["",b.required],userRoleID:["",b.required],orgUnitID:[""]})}users=[];editForm;selectedUser=null;showEditModal=!1;loading=!1;roles=[{value:1,viewValue:"Admin"},{value:2,viewValue:"Director"},{value:3,viewValue:"Manager"},{value:4,viewValue:"User"}];sidebarItems=[{icon:"fas fa-tachometer-alt",label:"Dashboard",active:!1,route:"/admin/dashboard"},{icon:"fas fa-bullhorn",label:"Advertisements",active:!1,route:"/admin/advertisements"},{icon:"fas fa-users",label:"User List",active:!0,route:"/admin/user-list"},{icon:"fas fa-user-plus",label:"Register User",active:!1,route:"/admin/user-registration"},{icon:"fas fa-chart-bar",label:"Reports",active:!1,route:"/admin/reports"},{icon:"fas fa-cog",label:"Settings",active:!1,route:"/admin/settings"}];ngOnInit(){this.loadUsers()}loadUsers(){this.loading=!0;let n=localStorage.getItem("auth_token"),e=new E().set("Authorization",`Bearer ${n}`);this.http.get("https://portal-api-z927.onrender.com/api/users",{headers:e}).subscribe({next:o=>{this.users=o.data,this.loading=!1},error:o=>{console.error("Failed to load users",o),this.loading=!1}})}openEditModal(n){this.selectedUser=n,this.editForm.patchValue({email:n.Email,firstName:n.FirstName,lastName:n.LastName,userRoleID:n.UserRoleID,orgUnitID:n.OrgUnitID}),this.showEditModal=!0}closeEditModal(){this.showEditModal=!1,this.selectedUser=null,this.editForm.reset()}onEditSubmit(){if(this.editForm.invalid||!this.selectedUser){this.editForm.markAllAsTouched();return}let n=localStorage.getItem("auth_token"),e=new E().set("Authorization",`Bearer ${n}`);this.http.put(`https://portal-api-z927.onrender.com/api/users/${this.selectedUser.UserID}`,this.editForm.value,{headers:e}).subscribe({next:o=>{h.default.fire({icon:"success",title:"Success!",text:"User updated successfully"}),this.closeEditModal(),this.loadUsers()},error:o=>{console.error("Error updating user:",o),h.default.fire({icon:"error",title:"Error",text:"Failed to update user"})}})}deleteUser(n){h.default.fire({title:"Are you sure?",text:`Do you want to delete user ${n.FirstName} ${n.LastName}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"}).then(e=>{if(e.isConfirmed){let o=localStorage.getItem("auth_token"),s=new E().set("Authorization",`Bearer ${o}`);this.http.delete(`https://portal-api-z927.onrender.com/api/users/${n.UserID}`,{headers:s}).subscribe({next:m=>{h.default.fire({icon:"success",title:"Deleted!",text:"User has been deleted."}),this.loadUsers()},error:m=>{console.error("Error deleting user:",m),h.default.fire({icon:"error",title:"Error",text:"Failed to delete user"})}})}})}setActiveSidebar(n){this.sidebarItems.forEach(e=>e.active=!1),n.active=!0}logout(){this.router.navigate(["/login"])}getRoleName(n){let e=this.roles.find(o=>o.value===n);return e?e.viewValue:"Unknown"}getRoleBadgeClass(n){switch(n){case 1:return"bg-red-100 text-red-800";case 2:return"bg-yellow-100 text-yellow-800";case 3:return"bg-blue-100 text-blue-800";case 4:return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}}static \u0275fac=function(e){return new(e||l)(y(W),y(V),y(R))};static \u0275cmp=C({type:l,selectors:[["app-user-list"]],decls:28,vars:6,consts:[[1,"flex","min-h-screen","bg-gradient-to-br","from-gray-50","to-gray-100"],[1,"w-72","bg-gradient-to-br","from-gray-600","to-green-700","text-white","p-8","shadow-xl","fixed","h-full","left-0","top-0","overflow-y-auto","z-50"],[1,"text-xl","font-bold","mb-8","text-center","text-white","drop-shadow-lg"],["class","flex items-center w-full px-5 py-4 mb-3 bg-white/10 border border-white/20 rounded-xl text-white font-medium cursor-pointer transition-all duration-300 hover:bg-white/20 hover:translate-x-1 hover:shadow-lg backdrop-blur-sm",3,"bg-white/25","routerLink","click",4,"ngFor","ngForOf"],[1,"flex-1","ml-72","p-8","bg-gray-50","min-h-screen"],[1,"flex","justify-between","items-center","mb-8","pb-5","border-b-2","border-gray-200"],[1,"text-3xl","font-semibold","text-gray-800"],[1,"flex","items-center","gap-8","px-6","py-4","mr-4","bg-white","rounded-2xl","shadow-lg","border","border-gray-100","transition-all","duration-300","hover:shadow-xl","hover:-translate-y-1"],[1,"ext-gray-700","font-semibold","bg-gradient-to-r","from-gray-600","to-green-700","bg-clip-text","text-transparent"],[1,"w-11","h-11","rounded-full","bg-gradient-to-r","from-gray-600","to-green-700","text-white","flex","items-center","justify-center","font-bold","cursor-pointer","transition-all","duration-300","hover:scale-110","shadow-md","border-2","border-white/30"],[1,"px-5","py-2.5","bg-gradient-to-r","from-gray-600","to-green-700","text-white","border-none","rounded-xl","font-semibold","cursor-pointer","transition-all","duration-300","hover:from-gray-700","hover:to-green-800","hover:shadow-lg","hover:-translate-y-0.5","overflow-hidden","relative",3,"click"],[1,"relative","z-10"],[1,"absolute","inset-0","bg-gradient-to-r","from-transparent","via-white/20","to-transparent","-translate-x-full","transition-transform","duration-700","hover:translate-x-full"],[1,"bg-white","rounded-2xl","p-8","shadow-lg","border","border-gray-100"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-semibold","text-gray-800"],[1,"px-5","py-2.5","bg-gradient-to-r","from-gray-600","to-green-700","text-white","border-none","rounded-xl","font-semibold","cursor-pointer","transition-all","duration-300","hover:from-gray-700","hover:to-green-800","hover:shadow-lg","hover:-translate-y-0.5","overflow-hidden","relative",3,"routerLink"],["class","text-center py-8",4,"ngIf"],["class","overflow-x-auto",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",3,"click",4,"ngIf"],[1,"flex","items-center","w-full","px-5","py-4","mb-3","bg-white/10","border","border-white/20","rounded-xl","text-white","font-medium","cursor-pointer","transition-all","duration-300","hover:bg-white/20","hover:translate-x-1","hover:shadow-lg","backdrop-blur-sm",3,"click","routerLink"],[1,"mr-4","text-xl","w-5","text-center"],[1,"text-center","py-8"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-indigo-600","mx-auto"],[1,"sr-only"],[1,"overflow-x-auto"],[1,"w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-2","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],["class","hover:bg-gray-50",4,"ngFor","ngForOf"],[1,"hover:bg-gray-50"],[1,"px-2","py-4","text-sm","font-medium","text-gray-900"],[1,"px-2","py-4","text-sm","text-gray-500"],[1,"px-2","py-4"],[1,"px-2","inline-flex","text-xs","leading-5","font-semibold","rounded-full"],[1,"px-2","py-4","text-sm","font-medium"],[1,"text-green-900","hover:text-green-900","mr-1",3,"click"],[1,"fas","fa-edit"],[1,"text-red-600","hover:text-red-900",3,"click"],[1,"fas","fa-trash"],[1,"text-center","py-12"],[1,"fas","fa-users","text-6xl","text-gray-400","mb-4"],[1,"text-xl","font-semibold","text-gray-600","mb-2"],[1,"text-gray-500"],[1,"fixed","inset-0","bg-gray-600","bg-opacity-50","overflow-y-auto","h-full","w-full","z-50",3,"click"],[1,"relative","top-20","mx-auto","p-5","border","w-96","shadow-lg","rounded-md","bg-white",3,"click"],[1,"mt-3"],[1,"text-lg","font-medium","text-gray-900","mb-4"],[3,"ngSubmit","formGroup"],[1,"mb-4"],[1,"block","text-sm","font-medium","text-gray-700"],["type","text","formControlName","firstName","placeholder","Enter first name",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500"],["class","text-red-500 text-sm mt-1",4,"ngIf"],["type","text","formControlName","lastName","placeholder","Enter last name",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500"],["type","email","formControlName","email","placeholder","Enter email address",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500"],["formControlName","userRoleID",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500"],["disabled","",3,"ngValue"],[3,"value",4,"ngFor","ngForOf"],["type","number","formControlName","orgUnitID","placeholder","Enter unit ID",1,"mt-1","block","w-full","border-gray-300","rounded-md","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500"],[1,"flex","justify-end","space-x-2"],["type","button",1,"px-4","py-2","bg-gray-300","text-gray-700","rounded-md","hover:bg-gray-400",3,"click"],["type","submit",1,"px-4","py-2","bg-blue-500","text-white","rounded-md","hover:bg-blue-600",3,"disabled"],[1,"text-red-500","text-sm","mt-1"],[4,"ngIf"],[3,"value"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"h3",2),r(3,"Admin Portal"),t(),c(4,X,3,6,"a",3),t(),i(5,"div",4)(6,"div",5)(7,"h2",6),r(8,"User Management"),t(),i(9,"div",7)(10,"span",8),r(11,"Welcome, Admin"),t(),i(12,"div",9),r(13,"A"),t(),i(14,"a",10),f("click",function(){return o.logout()}),i(15,"span",11),r(16,"Logout"),t(),p(17,"span",12),t()()(),i(18,"div",13)(19,"div",14)(20,"h3",15),r(21,"All Users"),t(),i(22,"button",16),r(23,"Register New User"),t()(),c(24,Z,4,0,"div",17)(25,te,18,1,"div",18)(26,ie,6,0,"div",19),t()(),c(27,me,38,8,"div",20),t()),e&2&&(a(4),d("ngForOf",o.sidebarItems),a(18),d("routerLink","/admin/user-registration"),a(2),d("ngIf",o.loading),a(),d("ngIf",!o.loading),a(),d("ngIf",!o.loading&&o.users.length===0),a(),d("ngIf",o.showEditModal))},dependencies:[L,k,N,Y,B,H,P,A,z,G,O,$,q,j,D,M,T],encapsulation:2})};export{J as UserListComponent};
