import{a as D}from"./chunk-7CK3I62G.js";import{a as P}from"./chunk-N5RQHMOU.js";import{$ as n,J as c,Q as d,R as v,Ta as M,W as x,_ as F,_a as S,aa as r,eb as y,ia as C,ja as g,ka as f,q as b,qb as I,t as _,ua as i,v as p,va as u,w as l,ya as O}from"./chunk-ZQSPQ25S.js";var h=class a{constructor(e){this.http=e}apiUrl="https://portal-api-z927.onrender.com/api/hierarchy";getSubordinates(e){return this.http.get(`${this.apiUrl}https://portal-api-z927.onrender.com/subordinates/${e}`)}getReportsByRole(e){return this.http.get(`${this.apiUrl}https://portal-api-z927.onrender.com/reports/${e}`)}getFormsByReportingLine(e,t){return this.http.get(`${this.apiUrl}https://portal-api-z927.onrender.com/forms/${e}/${t}`)}approveForm(e,t){return this.http.post(`${this.apiUrl}https://portal-api-z927.onrender.com/approve/${e}`,{approverId:t})}generateReport(e){return this.http.post(`${this.apiUrl}https://portal-api-z927.onrender.com/reports/generate`,e,{responseType:"blob"})}static \u0275fac=function(t){return new(t||a)(_(y))};static \u0275prov=b({token:a,factory:a.\u0275fac,providedIn:"root"})};function $(a,e){if(a&1){let t=C();n(0,"li"),i(1),n(2,"button",6),g("click",function(){let s=p(t).$implicit,m=f();return l(m.approveForm((s.instance_id==null?null:s.instance_id.toString())||""))}),i(3,"Approve"),r(),n(4,"button",6),g("click",function(){let s=p(t).$implicit,m=f();return l(m.rejectForm((s.instance_id==null?null:s.instance_id.toString())||""))}),i(5,"Reject"),r(),n(6,"button",6),g("click",function(){let s=p(t).$implicit,m=f();return l(m.escalateToDG((s.instance_id==null?null:s.instance_id.toString())||""))}),i(7,"Escalate to DG"),r()()}if(a&2){let t=e.$implicit;c(),O(" Form ID: ",t.form_type_id," - ",t.form_status," - Amount: ",t.total_amount," ")}}var k=class a{constructor(e,t,o){this.hierarchyService=e;this.formService=t;this.authService=o}financeForms=[];pendingFinanceForms=[];totalBudget=0;userId="";ngOnInit(){this.userId=this.authService.getToken()||"",this.loadFinanceData()}loadFinanceData(){this.formService.getFormsByReportingLine("fa_manager",this.userId).subscribe({next:e=>{this.financeForms=e.filter(t=>t.form_type_id>0),this.pendingFinanceForms=this.financeForms.filter(t=>t.form_status==="pending"),this.totalBudget=this.financeForms.reduce((t,o)=>t+(o.total_amount||0),0)},error:e=>console.error("Error loading finance data:",e)})}approveForm(e){this.hierarchyService.approveForm(e,this.userId).subscribe({next:()=>this.loadFinanceData(),error:t=>console.error("Approval error:",t)})}rejectForm(e){console.log("Rejecting finance form:",e),this.loadFinanceData()}escalateToDG(e){console.log("Escalating finance form to DG:",e),this.loadFinanceData()}static \u0275fac=function(t){return new(t||a)(d(h),d(D),d(P))};static \u0275cmp=v({type:a,selectors:[["app-fa-manager-dashboard"]],decls:29,vars:4,consts:[[1,"dashboard-container"],[1,"metrics-grid"],[1,"metric-card"],[1,"forms-section"],[4,"ngFor","ngForOf"],[1,"budget-section"],[3,"click"]],template:function(t,o){t&1&&(n(0,"div",0)(1,"h1"),i(2,"FA Manager Dashboard"),r(),n(3,"div",1)(4,"div",2)(5,"h3"),i(6,"Finance Reports"),r(),n(7,"p"),i(8),r()(),n(9,"div",2)(10,"h3"),i(11,"Pending Imprest/Claims"),r(),n(12,"p"),i(13),r()(),n(14,"div",2)(15,"h3"),i(16,"Total Budget Allocation"),r(),n(17,"p"),i(18),r()()(),n(19,"div",3)(20,"h3"),i(21,"Pending Finance Forms"),r(),n(22,"ul"),x(23,$,8,3,"li",4),r()(),n(24,"div",5)(25,"h3"),i(26,"Budget Overview"),r(),n(27,"p"),i(28,"Current allocation and usage summary for FA."),r()()()),t&2&&(c(8),u(o.financeForms.length),c(5),u(o.pendingFinanceForms.length),c(5),u(o.totalBudget),c(5),F("ngForOf",o.pendingFinanceForms))},dependencies:[S,M,I],styles:[".dashboard-container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto}.metrics-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin:20px 0}.metric-card[_ngcontent-%COMP%]{background:#f5f5f5;padding:20px;border-radius:8px;text-align:center;box-shadow:0 2px 4px #0000001a}.metric-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 10px;color:#333}.metric-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#007bff;margin:0}.forms-section[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]{margin-top:30px}.forms-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .budget-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#333;border-bottom:2px solid #007bff;padding-bottom:10px}.forms-section[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0}.forms-section[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:10px;background:#f8f9fa;margin:5px 0;border-radius:4px;border-left:4px solid #007bff;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap}button[_ngcontent-%COMP%]{background:#28a745;color:#fff;border:none;padding:5px 10px;border-radius:4px;cursor:pointer;margin-left:5px;margin-bottom:5px}button.reject[_ngcontent-%COMP%]{background:#dc3545}button.reject[_ngcontent-%COMP%]:hover{background:#c82333}button.escalate[_ngcontent-%COMP%]{background:#ffc107;color:#000}button.escalate[_ngcontent-%COMP%]:hover{background:#e0a800}button[_ngcontent-%COMP%]:hover{background:#218838}"]})};export{k as FaManagerDashboardComponent};
